<%- include('./header.ejs'); %>
  <div id="chat-container">
    <div id="search-container">
      <!-- <input type="text" placeholder="Search" /> -->
      <div class="new-message-container" onclick="openModal()">
        <a href="#"><img src="./images/search.png" alt="Search" /></a>
      </div>

      <a href="/users"><img src="./images/all_users.png" alt="All users" /></a>
    </div>
    <div id="conversation-list">
      <div class="conversation active">
        <img src="./images/user1.png" alt="Sumit" />
        <div class="title-text">Yousuf Islam</div>
        <di class="created-date"> Apr 16 </di>
        <div class="conversation-message">This is a message</div>
      </div>
      <div class="conversation">
        <img src="./images/user2.png" alt="Sumit" />
        <div class="title-text">Emran Hossain</div>
        <di class="created-date"> Apr 16 </di>
        <div class="conversation-message">This is a message</div>
      </div>
    </div>
    <div id="new-message-container">
      <a href="#" onclick="logout()">Logout</a>
    </div>

    <div id="chat-title">
      <span id="conversation-partner">Emran</span>
      <img src="./images/trash.png" alt="Delete Conversation" />
    </div>

    <!-- <div id="chat-message-list">
      <div class="nothing">select a conversation</div>
    </div> -->

    <form id="chat-form" method="post" enctype="multipart/form-data">
      <label for="attachment"><img src="./images/attachment.png" alt="Add Attachment" /></label>
      <input type="file" multiple name="attachment" class="hide" id="attachment" />
      <input type="text" name="message" placeholder="Type a message" autocomplete="off" />
    </form>

    <div id="chat-message-list">
      <div class="message-row other-message">
        <div class="message-content">
          <img src="./images/user1.png" alt="Sumit" />
          <div class="message-text">Ok then</div>
          <div class="message-time">Apr 16</div>
        </div>
      </div>
      <div class="message-row you-message">
        <div class="message-content">
          <div class="message-text">Lorem ipsum dolor sit amet</div>
          <div class="message-time">Apr 16</div>
        </div>
      </div>
    </div>

    <!-- <div id="chat-form">
      <img src="./images/attachment.png" alt=Add Attachment"" />
      <input type="text" placeholder="Type a message" />
    </div> -->
  </div>

  <div class="modal-wrapper">
    <div class="modal">
      <a href="#" class="modal-close">+</a>
      <div class="modal-title">
        <h2>Create New Conversation</h2>
      </div>
      <div class="modal-body">
        <form>
          <input type="text" placeholder="Name" />
          <input type="text" placeholder="Username" />
          <input type="button" value="Submit" />
        </form>
      </div>
    </div>
  </div>


  <%- include('./add-conversation-modal.ejs'); %>

    <script>
      const form = document.querySelector('#chat-form');
      const messageContainer = document.querySelector('#chat-message-list');
      const chatTitleContainer = document.querySelector('#conversation-partner');
      const loggedinUserId = '<%= loggedInUser.userid %>';
      const loggedinUserName = '<%= loggedInUser.username %>';
      let participant = null; // selected conversation participant object
      let current_conversation_id; // selected conversation id


      // logout function 
      const logoutToast = Toastify({
        text: "You are being logged out...",
        duration: 1000,
      });
      function logout() {
        fetch("/", {
          method: "DELETE",
        });
        logoutToast.showToast();
        setTimeout(() => {
          window.location.replace("/");
        }, 1000);
      }
    </script>
    </body>

    </html>